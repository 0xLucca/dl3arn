import { ConnectButton } from "@rainbow-me/rainbowkit";
import type { NextPage } from "next";
import Head from "next/head";
import { useAccount, useContractRead } from "wagmi";
import styles from "../styles/Home.module.css";
import { NFTabi } from "../abis/NFTabi";
import React from "react";

const Home: NextPage = () => {
  const [unlocked, setUnlocked] = React.useState(false);

  const { address, isConnecting, isDisconnected } = useAccount();

  const { data: hasNft } = useContractRead({
    addressOrName: "0x635321aDC5912Ede895F144CC9048baAE24e6E67",
    contractInterface: NFTabi,
    functionName: "balanceOf",
    watch: true,
    args: [address, 1],
  });

  React.useEffect(() => {
    if (hasNft) {
      let result = hasNft.toNumber();
      if (!!result) {
        // false if result==0
        setUnlocked(false);
      } else {
        setUnlocked(true);
      }
    }
  }, [hasNft]);

  return (
    <div>
      <Head>
        <title>DL3arn | Landing</title>
        <meta
          name="description"
          content="Generated by @rainbow-me/create-rainbowkit"
        />
        <link rel="icon" href="/favicon.ico" />
      </Head>

      <main style={{ display: "grid", placeItems: "center", height: "100vh" }}>
        <div>
          <h1>DL3arn</h1>
          <ConnectButton />
        </div>
        <div>
          <h1 style={{ margin: "12px 0 24px" }}>
            Locked Page: {unlocked.toString()}
          </h1>
        </div>
      </main>
    </div>
  );
};

export default Home;
